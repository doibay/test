/**
 * Resources for Like 2 Unlock for jQuery
 * http://codecanyon.net/item/like-2-unlock-for-jquery/2822035
 * Ported to XenForo by GoodForNothing Coders
 * Please contact GoodForNothing Coders @ license(at)gfnlabs.com for extended license information.
 * 
 * Copyright 2012, Paul Kashtanoff (from OnePress).
 */

(function ($) {

    if (!$.onepress) $.onepress = {};
    if (!$.onepress.lang) $.onepress.lang = {};

    $.onepress.lang.tolike = {

        defaultMessage: 'This content is locked. Please like us to view the hidden content.',
        loginMessage: 'You must log in to perform this action.',   
        orWait: 'or wait',
        close: 'Close'
    };
})(jQuery);;;

(function(a){if(!a.onepress){a.onepress={};}if(!a.onepress.tools){a.onepress.tools={};}a.onepress.tools.cookie=a.onepress.tools.cookie||function(e,k,f){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(k))||k===null||k===undefined)){f=a.extend({},f);if(k===null||k===undefined){f.expires=-1;}if(typeof f.expires==="number"){var b=f.expires,j=f.expires=new Date();j.setDate(j.getDate()+b);}k=String(k);return(document.cookie=[encodeURIComponent(e),"=",f.raw?k:encodeURIComponent(k),f.expires?"; expires="+f.expires.toUTCString():"",f.path?"; path="+f.path:"",f.domain?"; domain="+f.domain:"",f.secure?"; secure":""].join(""));}f=k||{};var c=f.raw?function(i){return i;}:decodeURIComponent;var h=document.cookie.split("; ");for(var d=0,g;g=h[d]&&h[d].split("=");d++){if(c(g[0])===e){return c(g[1]||"");}}return null;};a.onepress.tools.hash=a.onepress.tools.hash||function(e){var c=0;if(e.length==0){return c;}for(var d=0;d<e.length;d++){var b=e.charCodeAt(d);c=((c<<5)-c)+b;c=c&c;}c=c.toString(16);c=c.replace("-","0");return c;};})(jQuery);(function(a){if(!a.onepress){a.onepress={};}if(a.onepress.facebook){return;}a.onepress.facebook={_sdkScriptId:"facebook-jssdk",_root:null,_eventsCreated:false,_isConnected:false,_isLoaded:false,_loggedIntoFacebook:false,_isFB:function(){return(typeof(window.FB)==="object");},_isSdkconnected:function(){return(a("#"+this._sdkScriptId).length>0||a("script[src='^http://connect.facebook.net/']").length>0);},_isSdkLoading:function(){return !this._isFB()&&this._isSdkconnected();},_isSdkNotLoaded:function(){return !this._isFB()&&!this._isSdkconnected();},_isSdkLoaded:function(){return this._isFB();},loadSDK:function(b,d,c){if(c){if(this._isLoaded){c();}else{this.bind("fb-init",function(){c();});}}this._createEvents(b);if(this._isSdkNotLoaded()){if(this._isConnected||this._isLoaded){return;}this._createRoot();var e=document.createElement("script");e.type="text/javascript";e.id=this._sdkScriptId;e.src="http://connect.facebook.net/"+d+"/all.js";this._root.after(e);a.onepress.facebook._isConnected=true;}},_createRoot:function(){this._root=a("#fb-root");if(this._root.length==0){this._root=a("<div id='fb-root'></div>").appendTo(a("body"));}},_createEvents:function(b,c){var e=this;if(this._eventsCreated&&!c){return;}this._eventsCreated=true;if(this._isSdkLoading()||this._isSdkNotLoaded()){var d=null;if(window.fbAsyncInit&&!c){d=window.fbAsyncInit;}window.fbAsyncInit=function(){if(d){d();}e._fbInit(b);e._fbInitEvents();e._isLoaded=true;a(document).trigger("fb-init");window.fbAsyncInit=function(){};};}else{if(this._isSdkLoaded()){this._fbInit(b);}this._fbInitEvents();e._isLoaded=true;a(document).trigger("fb-init");}},_fbInit:function(b){window.FB.init({appId:b,status:true,cookie:true,xfbml:true});window.FB.init=function(){};},_fbInitEvents:function(){var b=this;window.FB.Event.subscribe("edge.create",function(c){a(document).trigger("fb-like",[c]);});window.FB.Event.subscribe("edge.remove",function(c){a(document).trigger("fb-dislike",c);});window.FB.Event.subscribe("xfbml.render",function(){a(document).trigger("fb-render");});},renderWidget:function(c){var d=c.data("facebook-widget");if(d){var b=d.getHtmlToRender();b.find(".fake-fb-like").addClass("fb-like");window.FB.XFBML.parse(b[0]);c.trigger("fb-render");}},bind:function(c,b){a(document).bind(c,b);},isLogged:function(b){if(this._isLoginChecked){b(this._isAuth,this._isLoggetInto);return;}var c=this;this._isLoggedChecked=true;if(this._loginStateisChecking){a(document).bind("fb-is-logged",function(){b(c._isAuth,c._isLoggetInto);});return;}this._loginStateisChecking=true;window.FB.getLoginStatus(function(d){c._isLoginChecked=true;c._isLoggetInto=!(d.status=="unknown");c._isAuth=d&&d.authResponse;b(d&&d.authResponse,!(d.status=="unknown"));c._loginStateisChecking=false;a(document).trigger("fb-is-logged");});},login:function(b){var c=a.onepress.facebook.permissions?a.onepress.facebook.permissions:"";window.FB.login(function(d){self._isLoggetInto=self._isAuth=d&&d.authResponse;self._isLoginChecked=true;b(d&&d.authResponse);},{scope:c});},isUrlLiked:function(e,b){var d=this;function c(f){return f&&parseInt(f)>0;}this.getPageIdByUrl(e,function(g,f){if(!c(g)){b(false,"Unable to get a Facebook page id of the specified URL to check whether a user likes the URL or not. Use the Soft Mode or set other URL. Used URL: "+e);}else{d.isPageIdLiked(g,function(i,h){b(i,h);});}});},pageIdCache:[],getPageIdByUrl:function(c,b){var f=c.replace(/^(https?\:\/\/)?(www.)?facebook.com\/?/,"");var e=this;var d=false;a.each(this.pageIdCache,function(g,h){if(h.url==h){d=h.pageId;return false;}});if(d&&b){b(d);return;}window.FB.api("/",{id:f},function(g){if(!g.error){e.pageIdCache.push({url:f,pageId:g.id});b(g.id);}else{b(false,g.error.message);}});return;},isPageIdLiked:function(c,b,d){var e=this;if(!c){return b(false,"The pageId is underfined.");}window.FB.api("/me/likes/"+c,function(f){if(!f.error){b(f.data.length>0);}else{if(f.error.type=="OAuthException"&&!d){(console.log&&console.log("OAuthException rised, wait 1500ms"));setTimeout(function(){e.isPageIdLiked(c,b,true);},1500);}else{b(false,f.error.message);}}});}};a(function(){return window.facebookSDK&&a.onepress.facebook.loadSDK(window.facebookSDK.appId,window.facebookSDK.lang);});})(jQuery);(function(a,d){if(a.widget){return;}var e=0,c=Array.prototype.slice,b=a.cleanData;a.cleanData=function(h){for(var j=0,g;(g=h[j])!=null;j++){try{a(g).triggerHandler("remove");}catch(f){}}b(h);};a.widget=function(k,f,m){var j,i,h,g,l=k.split(".")[0];k=k.split(".")[1];j=l+"-"+k;if(!m){m=f;f=a.Widget;}a.expr[":"][j.toLowerCase()]=function(n){return !!a.data(n,j);};a[l]=a[l]||{};i=a[l][k];h=a[l][k]=function(o,n){if(!this._createWidget){return new h(o,n);}if(arguments.length){this._createWidget(o,n);}};a.extend(h,i,{version:m.version,_proto:a.extend({},m),_childConstructors:[]});g=new f();g.options=a.widget.extend({},g.options);a.each(m,function(n,o){if(a.isFunction(o)){m[n]=(function(){var p=function(){return f.prototype[n].apply(this,arguments);},q=function(r){return f.prototype[n].apply(this,r);};return function(){var r=this._super,s=this._superApply,t;this._super=p;this._superApply=q;t=o.apply(this,arguments);this._super=r;this._superApply=s;return t;};})();}});h.prototype=a.widget.extend(g,{widgetEventPrefix:g.widgetEventPrefix||k},m,{constructor:h,namespace:l,widgetName:k,widgetBaseClass:j,widgetFullName:j});if(i){a.each(i._childConstructors,function(p,n){var o=n.prototype;a.widget(o.namespace+"."+o.widgetName,h,n._proto);});delete i._childConstructors;}else{f._childConstructors.push(h);}a.widget.bridge(k,h);};a.widget.extend=function(j){var f=c.call(arguments,1),g=0,h=f.length,i,k;for(;g<h;g++){for(i in f[g]){k=f[g][i];if(f[g].hasOwnProperty(i)&&k!==d){if(a.isPlainObject(k)){j[i]=a.isPlainObject(j[i])?a.widget.extend({},j[i],k):a.widget.extend({},k);}else{j[i]=k;}}}}return j;};a.widget.bridge=function(g,h){var f=h.prototype.widgetFullName;a.fn[g]=function(k){var j=typeof k==="string",i=c.call(arguments,1),l=this;k=!j&&i.length?a.widget.extend.apply(null,[k].concat(i)):k;if(j){this.each(function(){var n,m=a.data(this,f);if(!m){return a.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+k+"'");}if(!a.isFunction(m[k])||k.charAt(0)==="_"){return a.error("no such method '"+k+"' for "+g+" widget instance");}n=m[k].apply(m,i);if(n!==m&&n!==d){l=n&&n.jquery?l.pushStack(n.get()):n;return false;}});}else{this.each(function(){var m=a.data(this,f);if(m){m.option(k||{})._init();}else{new h(k,this);}});}return l;};};a.Widget=function(){};a.Widget._childConstructors=[];a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(g,f){f=a(f||this.defaultElement||this)[0];this.element=a(f);this.uuid=e++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=a.widget.extend({},this.options,this._getCreateOptions(),g);this.bindings=a();this.hoverable=a();this.focusable=a();if(f!==this){a.data(f,this.widgetName,this);a.data(f,this.widgetFullName,this);this._on(this.element,{remove:function(h){if(h.target===f){this.destroy();}}});this.document=a(f.style?f.ownerDocument:f.document||f);this.window=a(this.document[0].defaultView||this.document[0].parentWindow);}this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:a.noop,widget:function(){return this.element;},option:function(h,l){var j=h,k,f,g;if(arguments.length===0){return a.widget.extend({},this.options);}if(typeof h==="string"){j={};k=h.split(".");h=k.shift();if(k.length){f=j[h]=a.widget.extend({},this.options[h]);for(g=0;g<k.length-1;g++){f[k[g]]=f[k[g]]||{};f=f[k[g]];}h=k.pop();if(l===d){return f[h]===d?null:f[h];}f[h]=l;}else{if(l===d){return this.options[h]===d?null:this.options[h];}j[h]=l;}}this._setOptions(j);return this;},_setOptions:function(g){var f;for(f in g){this._setOption(f,g[f]);}return this;},_setOption:function(f,g){this.options[f]=g;if(f==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!g).attr("aria-disabled",g);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_on:function(g,h){var f,i=this;if(!h){h=g;g=this.element;f=this.widget();}else{g=f=a(g);this.bindings=this.bindings.add(g);}a.each(h,function(j,l){function m(){if(i.options.disabled===true||a(this).hasClass("ui-state-disabled")){return;}return(typeof l==="string"?i[l]:l).apply(i,arguments);}if(typeof l!=="string"){m.guid=l.guid=l.guid||m.guid||a.guid++;}var n=j.match(/^(\w+)\s*(.*)$/),k=n[1]+i.eventNamespace,o=n[2];if(o){f.delegate(o,k,m);}else{g.bind(k,m);}});},_off:function(f,g){g=(g||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;f.unbind(g).undelegate(g);},_delay:function(g,f){function h(){return(typeof g==="string"?i[g]:g).apply(i,arguments);}var i=this;return setTimeout(h,f||0);},_hoverable:function(f){this.hoverable=this.hoverable.add(f);this._on(f,{mouseenter:function(g){a(g.currentTarget).addClass("ui-state-hover");},mouseleave:function(g){a(g.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(f){this.focusable=this.focusable.add(f);this._on(f,{focusin:function(g){a(g.currentTarget).addClass("ui-state-focus");},focusout:function(g){a(g.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(k,h,g){var j,i,f=this.options[k];g=g||{};h=a.Event(h);h.type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase();h.target=this.element[0];i=h.originalEvent;if(i){for(j in i){if(!(j in h)){h[j]=i[j];}}}this.element.trigger(h,g);return !(a.isFunction(f)&&f.apply(this.element[0],[h].concat(g))===false||h.isDefaultPrevented());}};a.each({show:"fadeIn",hide:"fadeOut"},function(g,f){a.Widget.prototype["_"+g]=function(j,l,h){if(typeof l==="string"){l={effect:l};}var k,i=!l?g:l===true||typeof l==="number"?f:l.effect||f;l=l||{};if(typeof l==="number"){l={duration:l};}k=!a.isEmptyObject(l);l.complete=h;if(l.delay){j.delay(l.delay);}if(k&&a.effects&&(a.effects.effect[i]||a.uiBackCompat!==false&&a.effects[i])){j[g](l);}else{if(i!==g&&j[i]){j[i](l.duration,l.easing,h);}else{j.queue(function(m){a(this)[g]();if(h){h.call(j[0]);}m();});}}};});if(a.uiBackCompat!==false){a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName];};}})(jQuery);(function(a){a.widget("onepress.fblike",{options:{},_defaults:{onceEvent:true,url:null,sendButton:false,appId:0,lang:"en_US",layout:"standart",width:"auto",showFaces:false,verbToDisplay:"like",colorScheme:"light",font:"tahoma",ref:null,comment:true,permissions:null,render:null,like:null,dislike:null},_create:function(){var b=this;this._prepareOptions();this._setupEvents();this.element.data("facebook-widget",this);this._createButton();if(this.options.permissions){a.onepress.facebook.permissions=this.options.permissions;}a.onepress.facebook.loadSDK(this.options.appId,this.options.lang,function(){a.onepress.facebook.renderWidget(b.element);});},_prepareOptions:function(){var b=a.extend({},this._defaults);if(this.element.data("href")!==undefined){b.url=this.element.data("href");}if(this.element.data("send")!==undefined){b.sendButton=this.element.data("send");}if(this.element.data("layout")!==undefined){b.layout=this.element.data("layout");}if(this.element.data("show_faces")!==undefined){b.showFaces=this.element.data("show_faces");}if(this.element.data("width")!==undefined){b.width=this.element.data("width");}if(this.element.data("action")!==undefined){b.verbToDisplay=this.element.data("action");}if(this.element.data("font")!==undefined){b.font=this.element.data("font");}if(this.element.data("colorscheme")!==undefined){b.colorScheme=this.element.data("colorscheme");}if(this.element.data("ref")!==undefined){b.ref=this.element.data("ref");}b=a.extend(b,this.options);this.options=b;this.url=(!this.options.url)?window.location.href:this.options.url;},_setupEvents:function(){var b=this;a(document).bind("fb-init",function(){if(b.options.init){b.options.init();}});a(document).bind("fb-like",function(c,d){if(b.options.like&&b.url==d){b.options.like(d,b);}});a(document).bind("fb-dislike",function(c,d){if(b.options.dislike&&b.url==d){b.options.dislike(d,b);}});a(document).bind("fb-auth",function(c,d){alert("heere!");});a(this.element).bind("fb-render",function(){if(b.options.render){b.options.render(b.element,[b]);}});},_createButton:function(){var c;if(!this.element.is(".fb-like")){var b=a("<div class='fake-fb-like'></div>");b.data("facebook-widget",this);if(this.options.url){b.attr("data-href",this.options.url);}if(this.options.sendButton){b.attr("data-send",this.options.sendButton);}if(this.options.width){b.attr("data-width",this.options.width);}if(this.options.layout){b.attr("data-layout",this.options.layout);}b.attr("data-show-faces",this.options.showFaces);if(this.options.verbToDisplay){b.attr("data-action",this.options.verbToDisplay);}if(this.options.font){b.attr("data-font",this.options.font);}if(this.options.colorScheme){b.attr("data-colorscheme",this.options.colorScheme);}if(this.options.ref){b.attr("data-ref",this.options.ref);}this.element.append(b);c=this.element;}else{c=a("<div></div>").append(this.element);}c.addClass("ui-social-button ui-facebook ui-facebook-like");},getHtmlToRender:function(){if(this.element.is(".fb-like")){return this.element.parent();}return this.element;}});})(jQuery);(function(a){if(a.onepress.toLike){return;}a.widget("onepress.toLike",{options:{locker:{},facebook:{},events:{}},_defaults:{url:null,pageId:null,text:a.onepress.lang.tolike.defaultMessage,loginText:a.onepress.lang.tolike.loginMessage,style:null,highlight:true,demo:false,locker:{inverse:false,close:false,timer:false,strict:false,mobile:true,loggedOnly:false,watchdog:15000},content:null,facebook:{sendButton:false,appId:0,lang:"en_US",layout:null,width:null,showFaces:false,verbToDisplay:"like",colorScheme:"light",font:"tahoma",permissions:null},events:{lock:null,unlock:null,unlockByTimer:null,unlockByClose:null,unlockByWatchdog:null,ready:null}},_create:function(){var b=this;this._parseOptions();if(!this.options.locker.mobile&&/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){b._preUnlock("mobile");return;}this._provider=(!this.options.locker.strict)?new a.onepress.localFacebookStoreStateProvider(this.url,this,this.options.demo):new a.onepress.strictStateProvider(this.url,this,this.options.demo);if(this._error){this.element.show();return;}this._setLoadingState(true);if(!b.options.locker.strict&&b._provider.isUnlocked()){b._preUnlock("provider");return;}b._runWatchdog("[check-login]");this._checkLogin(function(d,c){b._stopWatchdog();if(b.options.locker.loggedOnly&&!c){b._preUnlock("loggedOnly");return;}b._showOverlay=!c;if(b.options.locker.strict){if(!c){b._lock("provider");if(b.options.ready){b.options.ready("locked");}return;}b._runWatchdog("[strict-mode-wait-provider]");b._provider.isUsable(function(f){b._stopWatchdog();b._showOverlay=!f;if(f){b._runWatchdog("[strict-mode-get-state]");b._provider.getState(function(g){b._stopWatchdog();!g?b._lock("provider"):b._unlock("provider");if(b.options.ready){b.options.ready(g?"unlocked":"locked");}});}else{b._lock("provider");if(b.options.ready){b.options.ready("locked");}}});}else{var e=b._provider.isUnlocked();!e?b._lock("provider"):b._unlock("provider");if(b.options.events.ready){b.options.events.ready(e?"unlocked":"locked");}}});},_parseOptions:function(){var b=a.extend(true,{},this._defaults,this.options);b.pageId=b.pageId||b.pageid;b.facebook.appId=b.facebook.appId||b.facebook.appid;if(!b.text){b.text=a.onepress.lang.tolike.defaultMessage;}b.text=(typeof b.text==="function"&&b.text(this))||(typeof b.text==="string"&&a("<div>"+b.text+"</div>"))||(typeof b.text==="object"&&b.text.clone());if(!b.loginText){b.loginText=a.onepress.lang.tolike.loginMessage;}b.loginText=(typeof b.loginText==="function"&&b.loginText(this))||(typeof b.loginText==="string"&&a("<div>"+b.loginText+"</div>"))||(typeof b.loginText==="object"&&b.loginText.clone());if(b.locker.timer&&!parseInt(b.locker.timer)){b.locker.timer=null;}b.locker.watchdog=parseInt(b.locker.watchdog);if(!b.facebook.appId){this._setError("Set Facebook App ID to use the Like 2 Unlock plugin. Create an app here: https://developers.facebook.com/apps");return;}this.url=this.url||this.options.url||window.location.href;this.identity=a.onepress.tools.hash(this.url);this.element.addClass("identity-"+this.identity).addClass("ui-locker-content");this.options=b;},_runWatchdog:function(c){if(!this.options.locker.watchdog){return;}var b=this;this._watchdog=setTimeout(function(){b._stoppedByWatchdog=true;b._unlock("watchdog");if(c&&console){var d="Watchdog: "+c;(console.debug&&console.debug(d))||(console.log&&console.log(d));}},this.options.locker.watchdog);},_stopWatchdog:function(){if(!this._watchdog){return;}clearTimeout(this._watchdog);this._watchdog=null;},_checkLogin:function(b){a.onepress.facebook.loadSDK(this.options.facebook.appId,this.options.facebook.lang,function(){a.onepress.facebook.isLogged(function(d,c){b(d,c);});});},_setLoadingState:function(c){if(!c){if(this.loadingState){this.loadingState.remove();}return;}var b=(this.element.parent().is("a"))?this.element.parent():this.element;this.loadingState=a("<div class='ui-locker-loading-holder'></div>").insertAfter(b);this.element.hide();},_setError:function(b){this._error=true;this._errorText=b;this._setLoadingState(false);this.locker&&this.locker.hide();this.element.html("<strong>[Error]: "+b+"</strong>");this.element.show().addClass("ui-facebook-locker-error");},_createMarkup:function(){var d=this;var c=(jQuery.browser.mozilla&&"mozilla")||(jQuery.browser.opera&&"opera")||(jQuery.browser.webkit&&"webkit")||"msie";this.locker=a("<div class='ui-locker-facebook ui-locker-"+c+"'></div>").hide();this.outerWrap=a("<div class='ui-locker-outer-wrap'></div>").appendTo(this.locker);this.innerWrap=a("<div class='ui-locker-inner-wrap'></div>").appendTo(this.outerWrap);this.element.addClass("ui-locker-content");this.locker.addClass(this.options.style);this.options.text.addClass("ui-locker-text").show();this.options.text.prepend((a("<div class='ui-locker-decorator-3'></div>")));this.options.text.append((a("<div class='ui-locker-decorator-4'></div>")));this.buttonsWrap=a("<div class='ui-locker-buttons'></div>");this.buttonWrap=a("<div class='ui-locker-button'></div>").appendTo(this.buttonsWrap);this.buttonsWrap.prepend(a("<div class='ui-locker-decorator-5'></div>"));this.innerWrap.append(a("<div class='ui-locker-decorator-1'></div>"));if(this.options.locker.inverse){this.innerWrap.append(this.buttonsWrap);this.innerWrap.append(this.options.text);this.locker.addClass("ui-locker-inverse");}else{this.innerWrap.append(this.options.text);this.innerWrap.append(this.buttonsWrap);}this.innerWrap.append(a("<div class='ui-locker-decorator-2'></div>"));this.buttonsWrap.append((a("<div class='ui-locker-decorator-6'></div>")));if(this._createSocialButtons){this._createSocialButtons(this.locker,this.buttonWrap);}this.options.locker.close&&this._createCloseButton();this.options.locker.timer&&this._createTimer();var b=(this.element.parent().is("a"))?this.element.parent():this.element;this.locker.insertAfter(b);this._showOverlay&&this._createOverlay();this._markupIsCreated=true;},_createCloseButton:function(){var b=this;this.closeButton=a("<div title='"+a.onepress.lang.tolike.close+"' class='ui-locker-close-icon'></div>");this.closeButton.prependTo(this.locker);this.closeButton.click(function(){if(!b.close||b.close(b)){b._unlock("close");}});},_createTimer:function(){this.timer=a("<span class='ui-locker-timer'></span>");var b=a.onepress.lang.tolike.orWait;this.timerLabel=a("<span class='ui-locker-timer-label'>"+b+" </span>").appendTo(this.timer);this.timerCounter=a("<span class='ui-locker-timer-counter'>"+this.options.locker.timer+"s</span>").appendTo(this.timer);this.timer.appendTo(this.locker);this.counter=this.options.locker.timer;this._kickTimer();},_createOverlay:function(){var e=this;var d=a("<div class='ui-locker-overlay'></div>").prependTo(e.locker);d.css({opacity:"0.05",marginTop:"-"+e.locker.css("borderTopWidth"),marginLeft:"-"+e.locker.css("borderLeftWidth")});var b=function(f){f.css({width:e.locker.outerWidth(),height:e.locker.outerHeight()});};b(d);var c=a("<div class='ui-locker-overlay-message'></div>").css("opacity",0).prependTo(this.locker);this.options.loginText.addClass("ui-locker-overlay-text").appendTo(c);a("<div class='ui-locker-overlay-button'></div>").appendTo(c);this.locker.hover(function(){b(d);c.css("marginTop",-c.outerHeight()/2);d.stop().animate({opacity:0.8},500);c.stop().animate({opacity:1},500);},function(){d.stop().animate({opacity:0.05},500);c.stop().animate({opacity:0},500);});d.add(c).click(function(){a.onepress.facebook.login(function(f){if(!f){return;}if(!e.options.locker.strict){a(document).trigger("fb-login");return;}e._provider.getState(function(h,g){a(document).trigger("fb-login");if(h){e._unlock("provider");}});});});a(document).bind("fb-login",function(){d.add(c).hide();});},_kickTimer:function(){var b=this;setTimeout(function(){if(!b._isLocked){return;}b.counter--;if(b.counter<=0){b._unlock("timer");}else{b.timerCounter.text(b.counter+"s");if(a.browser.opera){var c=b.timerCounter.clone();c.insertAfter(b.timerCounter);b.timerCounter.remove();b.timerCounter=c;}b._kickTimer();}},1000);},_recreateFacebookButton:function(){if(!this.socialButton){return;}var b=this.backup.clone().insertAfter(this.socialButton);this.socialButton.remove();this._createSocialButtons(this,b);},_createSocialButtons:function(d,b){var e=this;var c=a.extend({},this.options.facebook);if(this.options.url){c.url=this.options.url;}c.like=function(){e._unlock("button");};c.dislike=function(){e._lock("button");};this.backup=b.clone();this.socialButton=b.fblike(c);a(document).bind("fb-login",function(){e._recreateFacebookButton();});},_lock:function(c,b){this._setLoadingState(false);if(this._isLocked||this._stoppedByWatchdog){return;}if(!this._markupIsCreated){this._createMarkup();}if(c=="button"){this._provider.setState("locked");}this.element.hide();this.locker.fadeIn(1000);this._isLocked=true;if(this.options.events.lock){this.options.events.lock(this);}},_unlock:function(d,c){var b=this;this._setLoadingState(false);if(d=="watchdog"&&this.options.events.unlockByWatchdog){return this.options.events.unlockByWatchdog();}if(!this._isLocked){this._showContent(true);return false;}if(d=="button"){this._provider.setState("unlocked");}this._showContent(true);this._isLocked=false;if(d=="timer"&&this.options.events.unlockByTimer){return this.options.events.unlockByTimer();}if(d=="close"&&this.options.events.unlockByClose){return this.options.events.unlockByClose();}if(this.options.events.unlock){this.options.events.unlock();}},_preUnlock:function(c,b){this._setLoadingState(false);this._showContent(false);if(this.options.events.sready){this.options.events.ready("unlocked");}},_showContent:function(h){var g=this;var f=function(){if(g.locker){g.locker.hide();}if(!h){g.element.show();return;}g.element.fadeIn(1000,function(){g.options.highlight&&g.element.effect&&g.element.effect("highlight",{color:"#fffbcc"},800);});};if(!this.options.content){f();}else{if(typeof this.options.content==="string"){this.element.html(this.options.content);f();}else{if(typeof this.options.content==="object"&&!this.options.content.url){this.element.append(this.options.content.clone().show());f();}else{if(typeof this.options.content==="object"&&this.options.content.url){var b=a.extend(true,{},this.options.content);var e=b.success;var c=b.complete;var d=b.error;b.success=function(i,k,j){!e?g.element.html(i):e(g,i,k,j);f();};b.error=function(j,k,i){g._setError("An error is triggered during the ajax request! Text: "+k+" "+i);d&&d(j,k,i);};b.complete=function(i,j){c&&c(i,j);};a.ajax(b);}else{f();}}}}}});a.fn.tolike=function(b){b=a.extend({},b);a(this).toLike(b);};})(jQuery);(function(a){a.onepress.localFacebookStoreStateProvider=function(d,b,c){this.url=d;this.identity="page_"+a.onepress.tools.hash(d)+"_fb";this.isUsable=function(e){e(true);};this.lock=function(){};this.isUnlocked=function(){if(c){return false;}return(this._getValue())?true:false;};this.isLocked=function(){return !this.isUnlocked();};this.getState=function(e){e(this.isUnlocked());};this.setState=function(e){if(c){return false;}return e=="unlocked"?this._setValue():this._removeValue();};this._setValue=function(){if(localStorage){localStorage.setItem(this.identity,true);}else{a.onepress.tools.cookie(this.identity,true,{expires:356*10,path:"/"});}};this._getValue=function(){if(!localStorage){return a.onepress.tools.cookie(this.identity);}var e=localStorage.getItem(this.identity);if(e){return e;}e=a.onepress.tools.cookie(this.identity);if(e){this._setValue();}return e;};this._removeValue=function(){if(localStorage){localStorage.removeItem(this.identity);}a.onepress.tools.cookie(this.identity,null);};};a.onepress.strictStateProvider=function(e,b,c){var d=this;this.url=e;this.api=b;this.loggedIntoFacebook=false;this.isUsable=function(f){this.api._checkLogin(function(h,g){d.loggedIntoFacebook=g;if(f){f(h);}});};this.getState=function(f){if(c){return f(false);}if(d.api.options.pageId){a.onepress.facebook.isPageIdLiked(d.api.options.pageId,function(h,g){if(g){d.api._setError(g);return;}if(f){f(h,g);}});}else{a.onepress.facebook.isUrlLiked(d.url,function(h,g){if(g){d.api._setError(g);return;}if(f){f(h,g);}});}};this.setState=function(){};};})(jQuery);